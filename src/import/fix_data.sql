alter table planex add column plannr integer;
update planex set plannr = cast((regexp_matches("project_code", '^(\d{5})$'))[1] as integer);
create index plannr_idx on planex(plannr);
alter table planex rename column nw_begroot to nw_begroot_double;
alter table planex add column nw_begroot bigint;
alter table planex rename column prijspeildatum to prijspeildatum_old;
alter table planex add column prijspeildatum date;
update planex set nw_begroot = round(nw_begroot_double), prijspeildatum = to_date(prijspeildatum_old, 'DD-MM-YY');
alter table grex_grenzen_ogagis_2016 alter column plannr type integer;
alter table grex_grenzen_ogagis_2016 rename column startdatum to startdatum_old;
alter table grex_grenzen_ogagis_2016 add column startdatum date;
update grex_grenzen_ogagis_2016 set startdatum = to_date(startdatum_old, 'YYYYMMDD');
SELECT UpdateGeometrySRID('grex_grenzen_ogagis_2016', 'wkb_geometry', 28992);
update grex_grenzen_ogagis_2016 set wkb_geometry = ST_MakeValid(wkb_geometry) where ST_IsValid(wkb_geometry) = false;
